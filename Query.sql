CREATE TABLE Categories (
	_id UNIQUEIDENTIFIER  PRIMARY KEY DEFAULT NEWSEQUENTIALID(),
	_name NVARCHAR(4000) NOT NULL
);

CREATE TABLE Products (
	_id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWSEQUENTIALID(),
	_name NVARCHAR(4000) NOT NULL
);

CREATE TABLE  Products_Categories (
	_id_product UNIQUEIDENTIFIER  FOREIGN KEY REFERENCES Products(_id),
	_id_category UNIQUEIDENTIFIER FOREIGN KEY REFERENCES Categories(_id)
);


INSERT INTO Categories(_id, _name) VALUES ('88197112-1236-EE11-8595-7C50793A5AB5', 'Drinks'), ('89197112-1236-EE11-8595-7C50793A5AB5', 'Milk Drinks'), ('8A197112-1236-EE11-8595-7C50793A5AB5', 'Fruits')
INSERT INTO Products(_id, _name) 
VALUES ('8B197112-1236-EE11-8595-7C50793A5AB5', 'Milk'), ('8C197112-1236-EE11-8595-7C50793A5AB5', 'Fanta'), ('8D197112-1236-EE11-8595-7C50793A5AB5', 'Coca-Cola'), 
	   ('8E197112-1236-EE11-8595-7C50793A5AB5', 'Sprite'), ('8F197112-1236-EE11-8595-7C50793A5AB5', 'Mineral water'), ('90197112-1236-EE11-8595-7C50793A5AB5', 'Yogurt'),
	   ('91197112-1236-EE11-8595-7C50793A5AB5', 'Apple'), ('92197112-1236-EE11-8595-7C50793A5AB5', 'Banana'), ('93197112-1236-EE11-8595-7C50793A5AB5', 'Bread');



INSERT INTO Products_Categories(_id_product, _id_category) 
VALUES ('8B197112-1236-EE11-8595-7C50793A5AB5','88197112-1236-EE11-8595-7C50793A5AB5'), 
	   ('8B197112-1236-EE11-8595-7C50793A5AB5','89197112-1236-EE11-8595-7C50793A5AB5'), 
	   ('8C197112-1236-EE11-8595-7C50793A5AB5','88197112-1236-EE11-8595-7C50793A5AB5'), 
	   ('8D197112-1236-EE11-8595-7C50793A5AB5','88197112-1236-EE11-8595-7C50793A5AB5'),
	   ('8E197112-1236-EE11-8595-7C50793A5AB5','88197112-1236-EE11-8595-7C50793A5AB5'),
	   ('8F197112-1236-EE11-8595-7C50793A5AB5','88197112-1236-EE11-8595-7C50793A5AB5'),
	   ('90197112-1236-EE11-8595-7C50793A5AB5','89197112-1236-EE11-8595-7C50793A5AB5'),
	   ('91197112-1236-EE11-8595-7C50793A5AB5','8A197112-1236-EE11-8595-7C50793A5AB5'),
	   ('92197112-1236-EE11-8595-7C50793A5AB5','8A197112-1236-EE11-8595-7C50793A5AB5'),
	   ('90197112-1236-EE11-8595-7C50793A5AB5','88197112-1236-EE11-8595-7C50793A5AB5');



select * from Products
select * from Categories

--query
SELECT P._name AS _product_name, ISNULL(C._name,'NO CATEGORY') AS _category_name
		from Products_Categories Pc
			INNER JOIN Categories C on C._id = Pc._id_category
			RIGHT JOIN Products P on P._id = Pc._id_product
			ORDER BY _product_name